<!DOCTYPE html>
<html>
<head>
    <title>Game Menu</title>
    <style>
        body {
            background-color: #f2f2f2;
            font-family: Arial, sans-serif;
        }

        #menu {
            width: 400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }

        select {
            width: 100%;
            padding: 5px;
            font-size: 16px;
        }

        .color-picker {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .color-picker label {
            margin-right: 10px;
        }

        .color-picker input[type="color"] {
            padding: 0;
            border: none;
            height: 30px;
            width: 30px;
            appearance: none;
            border-radius: 50%;
            cursor: pointer;
        }

        #start-button {
            display: block;
            margin: 0 auto;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h1>Game Menu</h1>

        <label for="player-color">Player Color:</label>
        <input type="color" id="player-color" value="#ff0000">

        <label for="difficulty">Difficulty:</label>
        <select id="difficulty">
            <option value="easy">Easy</option>
            <option value="normal" selected>Normal</option>
            <option value="hard">Hard</option>
        </select>

        <button id="start-button">Start Game</button>
    </div>

    <canvas id="game-canvas" width="800" height="400"></canvas>

    <script>
        var canvas = document.getElementById("game-canvas");
        var ctx = canvas.getContext("2d");

        // Game variables
        var playerX = (canvas.width - 40) / 2;
        var playerY = (canvas.height - 40) / 2;
        var playerColor = "#ff0000";
        var playerWidth = 40;
        var playerHeight = 40;
        var isPlayerAlive = true;
        var bullets = [];
        var bulletSpeed = 4;
        var rect1Y = 0;
        var rect2Y = canvas.height - 40;
        var rectWidth = 20;
        var rectHeight = 40;
        var collectables = [];
        var collectableRadius = 10;
        var score = 0;
        var startTime;
        var difficultyMultiplier = 1;

        // Start the game when the Start Game button is clicked
        var startButton = document.getElementById("start-button");
        startButton.addEventListener("click", function() {
            var playerColorPicker = document.getElementById("player-color");
            playerColor = playerColorPicker.value;

            var difficultySelect = document.getElementById("difficulty");
            var difficulty = difficultySelect.value;
            if (difficulty === "easy") {
                difficultyMultiplier = 0.5;
            } else if (difficulty === "normal") {
                difficultyMultiplier = 1;
            } else if (difficulty === "hard") {
                difficultyMultiplier = 2;
            }

            startGame();
        });

        // Draw the game elements
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw player
            ctx.fillStyle = playerColor;
            ctx.fillRect(playerX, playerY, playerWidth, playerHeight);

            // Draw bullets
            ctx.fillStyle = "#000";
            for (var i = 0; i < bullets.length; i++) {
                ctx.fillRect(bullets[i].x, bullets[i].y, 4, 8);
            }

            // Draw moving rectangles
            ctx.fillStyle = "#000";
            ctx.fillRect(0, rect1Y, rectWidth, rectHeight);
            ctx.fillRect(canvas.width - rectWidth, rect2Y, rectWidth, rectHeight);

            // Draw collectables
            ctx.fillStyle = "#f00";
            for (var j = 0; j < collectables.length; j++) {
                ctx.beginPath();
                ctx.arc(collectables[j].x, collectables[j].y, collectableRadius, 0, Math.PI * 2);
                ctx.closePath();
                ctx.fill();
            }

            // Draw score and time
            ctx.fillStyle = "#000";
            ctx.font = "16px Arial";
            ctx.fillText("Score: " + score, 10, 20);
            ctx.fillText("Time: " + formatTime(Date.now() - startTime), 10, 40);
        }

        // Update game state
        function update() {
            // Move rectangles
            rect1Y += 2 * difficultyMultiplier;
            rect2Y -= 2 * difficultyMultiplier;

            // Move bullets
            for (var i = 0; i < bullets.length; i++) {
                bullets[i].y -= bulletSpeed * difficultyMultiplier;
            }

            // Check collision with bullets
            for (var i = bullets.length - 1; i >= 0; i--) {
                if (bullets[i].y < 0) {
                    bullets.splice(i, 1);
                    continue;
                }

                if (checkCollision(rect1Y, 0, rectWidth, rectHeight, bullets[i].x, bullets[i].y, 4, 8) ||
                    checkCollision(canvas.width - rectWidth, rect2Y, rectWidth, rectHeight, bullets[i].x, bullets[i].y, 4, 8)) {
                    bullets.splice(i, 1);
                    score += 10;
                }
            }

            // Check collision with collectables
            for (var j = collectables.length - 1; j >= 0; j--) {
                if (checkCollision(playerX, playerY, playerWidth, playerHeight, collectables[j].x - collectableRadius, collectables[j].y - collectableRadius, collectableRadius * 2, collectableRadius * 2)) {
                    collectables.splice(j, 1);
                    score += 50;
                }
            }

            // Check collision with player
            if (checkCollision(rect1Y, 0, rectWidth, rectHeight, playerX, playerY, playerWidth, playerHeight) ||
                checkCollision(canvas.width - rectWidth, rect2Y, rectWidth, rectHeight, playerX, playerY, playerWidth, playerHeight)) {
                isPlayerAlive = false;
            }

            // Generate new collectables
            if (Math.random() < 0.01 * difficultyMultiplier) {
                collectables.push({
                    x: Math.random() * (canvas.width - collectableRadius * 2) + collectableRadius,
                    y: Math.random() * (canvas.height - collectableRadius * 2) + collectableRadius
                });
            }
        }

        // Game loop
        function gameLoop() {
            if (isPlayerAlive) {
                update();
                draw();
                requestAnimationFrame(gameLoop);
            } else {
                alert("Game Over! Your score is: " + score);
            }
        }

        // Start the game
        function startGame() {
            playerX = (canvas.width - playerWidth) / 2;
            playerY = (canvas.height - playerHeight) / 2;
            isPlayerAlive = true;
            bullets = [];
            rect1Y = 0;
            rect2Y = canvas.height - rectHeight;
            collectables = [];
            score = 0;
            startTime = Date.now();
            gameLoop();
        }

        // Utility function to check collision between two rectangles
        function checkCollision(rect1X, rect1Y, rect1Width, rect1Height, rect2X, rect2Y, rect2Width, rect2Height) {
            return rect1X < rect2X + rect2Width &&
                rect1X + rect1Width > rect2X &&
                rect1Y < rect2Y + rect2Height &&
                rect1Y + rect1Height > rect2Y;
        }

        // Utility function to format time in seconds
        function formatTime(ms) {
            var totalSeconds = Math.floor(ms / 1000);
            var minutes = Math.floor(totalSeconds / 60);
            var seconds = totalSeconds % 60;
            return minutes + ":" + (seconds < 10 ? "0" : "") + seconds;
        }
    </script>
</body>
</html>
